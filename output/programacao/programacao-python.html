<!DOCTYPE html>
<html lang="pt_br">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="../theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Andre Souza" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="linguagem, Programacao, " />

<meta property="og:title" content="Programação em Dados com Python "/>
<meta property="og:url" content="../programacao/programacao-python.html" />
<meta property="og:description" content="Manipulações básicas e mais comuns com dados no Python" />
<meta property="og:site_name" content="PolyglotData" />
<meta property="og:article:author" content="Andre Souza" />
<meta property="og:article:published_time" content="2025-10-26T00:00:00-03:00" />
<meta name="twitter:title" content="Programação em Dados com Python ">
<meta name="twitter:description" content="Manipulações básicas e mais comuns com dados no Python">

        <title>Programação em Dados com Python  · PolyglotData
</title>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="../"><span class=site-name>PolyglotData</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       ..
                                    >Home</a>
                                </li>
                                <li ><a href="../contato.html">Contato</a></li>
                                <li ><a href="../categories.html">Categories</a></li>
                                <li ><a href="../tags.html">Tags</a></li>
                                <li ><a href="../archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="../search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="../programacao/programacao-python.html">
                Programação em Dados com Python
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <h2>Programação em Dados com Python</h2>
<p>Mãos a Obra. Vamos passar por alguns conceitos, detalhando os mesmos através de exemplos práticos de manipulação de dados.</p>
<p>Se efetivamente quiser reproduzir o que está listado abaixo será essencial, ter preparado o ambiente, o que foi descrito na seção:
<a href="../programacao/ambiente-trabalho.html" target="_blank">Configurando e Entendendo o Ambiente de Trabalho em Dados</a></p>
<p>Considerando isso alguns pontos são essenciais, recordar do ambiente de trabalho. Estamos usando o poetry, criamos um ambiente limpo, por isso
iremos sempre instalar o pacote e atualizar o ambiente virtual local.</p>
<p>Importante seu Vs Code esta configurado para ao abrir um terminal, ele já abra dentro do contexto do ambiente virtual do poetry, para as dependendencias serem instaladas corretamente.</p>
<h4>Manipulando arquivos CSV</h4>
<h5>Conceitos Basicos</h5>
<h6>Incluindo novas dependencias</h6>
<p>Nosso ambiente iniciou sem nem um pacote, que usaremos na programação, instalado. Dai antes de começar vamos adicionar o novo pacote que iremos usar nesse exemplo. Como comentado acima, essencial estarmos em nosso ambiente selecionado, o ambiente virtual do Poetry.</p>
<div class="highlight"><pre><span></span><code>poetry<span class="w"> </span>add<span class="w"> </span>pandas<span class="w"> </span>
poetry<span class="w"> </span>install
</code></pre></div>

<p>Vamos ao código:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Defini local onde esetão os dados</span>
<span class="n">nomeArquivo01</span> <span class="o">=</span> <span class="s1">&#39;dados/listapessoas01.csv&#39;</span>
<span class="n">nomeArquivo02</span> <span class="o">=</span> <span class="s1">&#39;dados/listapessoas02.csv&#39;</span>
<span class="n">nomeArquivoSaida</span> <span class="o">=</span> <span class="s1">&#39;dados/listapessoasUnida.csv&#39;</span>

<span class="c1"># Carrega os dados para o DataFrame do Pandas</span>
<span class="n">dfPrimeiroBloco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">nomeArquivo01</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">dfSegundoBloco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">nomeArquivo02</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

<span class="c1"># Garante padronização dos tipos de dados que serão usados para união dos arquivos</span>
<span class="n">dfPrimeiroBloco</span><span class="p">[</span><span class="s2">&quot;codigo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfPrimeiroBloco</span><span class="p">[</span><span class="s2">&quot;codigo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
<span class="n">dfSegundoBloco</span><span class="p">[</span><span class="s2">&quot;codigo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSegundoBloco</span><span class="p">[</span><span class="s2">&quot;codigo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="c1"># Verifica se os tipos de dados estão compatives</span>
<span class="n">display</span><span class="p">(</span><span class="n">dfPrimeiroBloco</span><span class="p">[</span><span class="s2">&quot;codigo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">,</span><span class="s1">&#39;tipo de dado da coluna &quot;codigo&quot; do primeiro arquivo&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dfSegundoBloco</span><span class="p">[</span><span class="s2">&quot;codigo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">,</span><span class="s1">&#39;tipo de dado da coluna &quot;codigo&quot; do segundo arquivo&#39;</span><span class="p">)</span>

<span class="c1"># Faz a união de ambos arquivos baseado na chave </span>
<span class="n">dfUniao</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfPrimeiroBloco</span><span class="p">,</span><span class="n">dfSegundoBloco</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;codigo&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;codigo&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Simples manipulação de dados no Pandas</span>
<span class="n">display</span><span class="p">(</span><span class="n">dfUniao</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Nome.str.contains(&quot;maria&quot;,case=False)&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">))</span>    

<span class="c1"># Os dois arquivos estão unidos nesse ponto já, dentro do dataframe. Agora vamos converter o resultado para um novo csv</span>
<span class="n">dfUniao</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">nomeArquivoSaida</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Vamos descrever sucintamente o que o codigo faz </p>
<ul>
<li>
<p>Defini local onde esetão os dados</p>
<p>Esse ponto simplesmente define os locais onde os arquivos estarão armazenados</p>
</li>
<li>
<p>Carrega os dados para o DataFrame do Pandas</p>
<p>Comando básico do pandas que carrega um csv para um DataFrame do Pandas, carrega em Memoria</p>
</li>
<li>
<p>Garante padronização dos tipos de dados que serão usados para união dos arquivos</p>
<p>Nesse primeiro exemplo não iremos entrar em muitos detalhes, mas é sempre importante validar os tipos de dados que serão usados como chave de união dos dois arquivos. Esse exemplo simples, não irá gerar problemas nem um. Mas no mundo real, com arquivos maiores onde não temos controle da fonte geradora, poderá ser necessário muitos tratamentos. Mas esse exemplo resolve alguns casos básicos de tipagem.</p>
</li>
<li>
<p>Verifica se os tipos de dados estão compatives</p>
<p>Por garantia é sempre bom validar, e para isso estamos imprimindo na tela, os tipos de dados das chaves de união, para evitar surpresas no caso de volumes altos de dados</p>
</li>
<li>
<p>Faz a união de ambos arquivos baseado na chave </p>
<p>Esse é uma união simples entre os dois arquivos( DataFrames ) usando algumas regrinhas basicas:</p>
<div class="highlight"><pre><span></span><code>Estou explicidamente definindo o &quot;left_on&quot; e &quot;right_one&quot; para tomar consciência que existe essa opção e os nomes das colunas poderiam ser um pouco diferentes.

Estou usando um operação de junção &quot;row=&#39;left&#39;&quot; para tratar alguns casos especiais, onde no arquivo ( DataFrame ) da esquerda podem ter mais linhas que o da direita, e mesmo assim traria sempre o resultado, nesse nosso exemplo garantindo que do lado esquerdo(&#39;left&#39;), traga todas as linhas independente se ela existir no que esta no arquivo ( DataFrame ) da direita

Acrescentamos o operador &quot;indicator=True&quot; para incluir uma nova coluna chamada &quot;_merge&quot;, no resultado final. No resultado poderá aparecer [&quot;both&quot;,&quot;only_left&quot;]. Onde o &quot;both&quot; indica que existem dados em ambos arquivos, e o &quot;only_left&quot; que o dado somente existe no arquivo1
</code></pre></div>

</li>
<li>
<p>Simples manipulação de dados no Pandas</p>
<p>Estamos usando um operador muito comum no NoteBook, de mostrar na tela o resultado que esta dentro do DataFrame, nesse caso estamos fazendo uma operação bem simples. Listando todos as linhas que tem no nome "maria" contido na coluna "Nome", o "case=False" garante que a pesquisa não fará diferença entre minúscula ou maiúscula</p>
</li>
<li>
<p>Os dois arquivos estão unidos nesse ponto já, dentro do dataframe. Agora vamos converter o resultado para um novo csv</p>
<p>Finalmente pegamos o resultado da união de ambos arquivos e salvamos ele em um novo arquivo apontado pelo caminho.</p>
</li>
</ul>
<p>É muito comum trabalhar com volumes grandes de dados, e tais dados estão muitas vezes em csv ou excel.
Nesse exemplo iremos fazer algumas manipulações básicas e comuns.</p>
<h4>Lendo dados em Diversos Formatos</h4>
<ul>
<li><em>Lendo dados no formato Json</em></li>
<li><em>Lendo dados no formato CSV</em></li>
<li><em>Lendo dados no format excel</em></li>
<li><em>Transformando todos eles em um mesmo padrão, tratamento de tipo</em></li>
<li><em>Unindo-os em um mesmo formato - Pandas</em></li>
<li><em>Salvando o resultado de nosso trabalho em um novo csv</em></li>
</ul>
<h4>Trabalhando com dados no Formato Json</h4>
<ul>
<li><em>Lendo dados no formato Json</em></li>
<li><em>Manipulando dados no formato Json</em></li>
<li><em>Serializando e Deserializando os dados Json</em></li>
<li><em>Convertendo o Json para Pandas</em></li>
<li>*Retornando o Pandas para Json e Persistindo em um arquivo o resultado</li>
</ul>
<h4>Substituindo o Sql pela manipulação no Pandas</h4>
<p>Com um bom conhecimento da linguagem Sql podemos fazer muitos tratamentos e processamentos, na manipulação de dados. Porem em python, ganhamos a liberdade de conectar em fontes diferentes e trabalhar com esses dados em um local centralizado, logo o formato e localização da fonte de dados deixa de ser um problema. Porem esse conhecimento não descarta as vantagens de dominar a linguagem Sql, que existem processos e recursos que essa linguagem nos oferece que é simplesmente imbatível em vantagens.
E não depender de fornecedor nem um apenas de sua criatividade e capacidade, é algo que inicialmente pode assustar mas destrava a liberdade para avançar muito.
No início tudo é mais desafiador, mas com o tempo, a familiarização e o conhecimento torna fácil aquilo que era aparentemente difícil no inicio. 
Dai a sugestão de investir na manipulação de dados via Python, nos tornamos independente de ferramentas de terceiro e o limite é estabelecido por uma linguagem de uso amplo no mercado, e que esta em constante avanço e atualizações.</p>
<h5>Manipulando dados com pandas*</h5>
<ul>
<li><em>Lendo um exemplo de dados em csv para manipulação</em></li>
<li><em>Iterando em blocos de dados do Pandas</em></li>
<li><em>Realizando pesquisas dentro de um bloco de dados dentro do Pandas</em></li>
<li><em>Salvando o resultado das manipulações de dados</em></li>
</ul>
<h5>Manipulando dados cuja origem é um banco relacional ( read_sql )</h5>
<ul>
<li><em>Conectando no banco de dados</em></li>
<li><em>Lendo dados no banco de dados</em></li>
<li><em>Tratamento de tipo na leitura de dados Sql para Pandas</em></li>
<li><em>Salvando os dados do banco de dados localmente, para evitar repetidas idas ao banco</em></li>
</ul>
<h5>Manipulando dados com iteração com um banco relacional ( to_sql )</h5>
<ul>
<li><em>Conectando no banco de dados</em></li>
<li><em>Lendo dados no banco de dados</em></li>
<li><em>Salvando os dados do banco de dados localmente, para evitar repetidas idas ao banco</em></li>
<li><em>Inserindo dados no banco de dados a partir do pandas</em></li>
<li><em>Atualizando dados no banco de dados a partir do pandas</em></li>
</ul>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2025-10-26T00:00:00-03:00">dom 26 outubro 2025</time>
            <h4>Category</h4>
            <a class="category-link" href="../categories.html#programacao-ref">Programacao</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="../tags.html#linguagem-ref">linguagem
                    <span class="superscript">4</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="../theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>